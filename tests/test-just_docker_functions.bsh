. "$(dirname ${BASH_SOURCE[0]})/testlib.sh"
. "$(dirname ${BASH_SOURCE[0]})/test_utils.bsh"

VSI_COMMON_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")/.."; pwd)"
. "${VSI_COMMON_DIR}/linux/colors.bsh"

begin_test "build recipes"
(
  touch blah.env

  echo "source_environment_files blah.env" > Justfile
  echo 'caseify(){ defaultify ${@+"${@}"}; }' >> Justfile

  echo "${VSI_COMMON_DIR}/linux/just_docker_functions.bsh" > .justplugins

  DOCKER_COMPOSE=echo
  [ "$(DRYRUN=echo just build recipes)" = "docker-compose -f ${VSI_COMMON_DIR}/docker/recipes/docker-compose.yml build" ]
)
end_test