#!/usr/bin/env bash

. "$(dirname ${BASH_SOURCE[0]})/testlib.sh"

VSI_COMMON_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")/.."; pwd)"

CWD="$(pwd)"

begin_test "wecho test"
(
  setup_test

  # Need to be in the original directory as when the script starts, or else
  # wecho does not work
  cd "${CWD}"

  ans=$'this\n  is\n   a\n\ntest'

  # Only works when sourced
  . "${VSI_COMMON_DIR}/linux/wecho.bsh"

  wecho "this
  is
            a

         test" | [ "$(cat -)" = "${ans}" ]

#Purposefully unindented
wecho "this
  is
          a

       test" | [ "$(cat -)" = "${ans}" ]

  ans="  ${ans}"
  wecho "  this
  is
            a

         test" | [ "$(cat -)" = "${ans}" ]

)
end_test
